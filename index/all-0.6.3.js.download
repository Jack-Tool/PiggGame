!function(t){t.AMB=t.AMB||{},AMB.VERSION="0.6.3"}(window),function(t){t.AMB=t.AMB||{},AMB.logLevel=AMB.logLevel||"FATAL",AMB.config={mode:"product",dev:0,key:{me:"_ambme",token:"_ambt",clientId:"_ambcid",fid:"_ambfid",sessionId:"_ambsid",bootstrap:"_ambbs",app:"_ambapp",storage:"_ambstrg",call:"_ambcall",pr:"_ambpr",logLvl:"_ambloglvl",config:"_ambcfg",recommend:"_ambrmd",category:"_ambctg"},scope:[],url:{www:"https://www.ameba.jp",home:"https://s.amebame.com",auth:"https://dauth.user.ameba.jp",tracking:"https://track.amebame.com",stat:"http://stat.amebame.com",stat_ssl:"https://ssl-stat.amebame.com",rule:"http://help.amebame.com/ameba-rules/",help_cnct:"http://help.amebame.com/ameba-rules/821/",help_rmt:"https://rd.amca.jp/f17E1cuEXaNZZzOUB46p",payment:"https://payment.amebame.com/coin/",news:"http://link.ameba.jp/236710/",blog:"http://link.ameba.jp/199921/",adcross:"https://ad.pr.ameba.jp/bulk"},amebame:{url:{home_header:"https://rd.amca.jp/1nhSSgNHCCxX2m5I1fcP"}},app:{jssdk:{id:"8193"}}}}(window),function(o){var s=o.document,i={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},c=Array.prototype.slice,u={};function l(t){return"string"==typeof t||t instanceof String}function h(t){return"number"==typeof t||t instanceof Number}function f(t){return t instanceof Object}function n(t){return t instanceof Array}function m(t){return null==t}function p(t){for(var e={},n=0;n<t.length;n++)e[t[n]]=1;return e}function d(t){return t?t.replace(/^\s+|\s+$/g,""):""}function g(t,e){l(t)?this.c=e.querySelectorAll(t):n(t)?this.c=t:this.c=[t]}function v(t){return m(t)?null:t instanceof g?t:new g(t,s)}var e={added:"DOMNodeInsertedIntoDocument",removed:"DOMNodeRemovedFromDocument"};function b(t){return t in e?e[t]:t}g.prototype={constructor:g,length:function(){return this.c.length},exist:function(t){var e=this.c;return 0<=t&&t<e.length&&(n(e)?!m(e[t]):!m(e.item(t)))},get:function(t){return n(this.c)?this.c[t]:this.c.item(t)},each:function(t){for(var e=this.c instanceof Array,n=0;n<this.c.length;n++)e?t.call(this.c[n]):t.call(this.c.item(n));return this},find:function(a){var r=[];return this.each(function(){for(var t=this.querySelectorAll(a),e=t.length,n=0;n<e;n++)r.push(t.item(n))}),v(r)},bound:function(t){var e=this.get(0).getBoundingClientRect(),n=t&&t.screen?0:s.body.scrollLeft,t=t&&t.screen?0:s.body.scrollTop;return{left:Math.floor(e.left+n),right:Math.floor(e.right+n),top:Math.floor(e.top+t),bottom:Math.floor(e.bottom+t),width:Math.floor(e.width),height:Math.floor(e.height)}},css:function(t){if(l(t))return this.get(0).style[t.replace(/-([a-z])/g,function(t){return t.toUpperCase().replace("-","")})]||getComputedStyle(this.get(0),"").getPropertyValue(t);if(0===arguments.length)return a={},this.get(0).style.cssText.split(";").forEach(function(t){t=t.match(/\s*(.+)\s*:\s*(.+)\s*/);t&&(a[t[1]]=t[2])}),a;var e,n,a="",r=t.reset;for(e in delete t.reset,t){var o=e.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()});a+=o+":"+(n=e,h(o=t[e])&&m(i[n])?o+"px":o)+";"}return this.each(function(){r?this.style.cssText=a:this.style.cssText+=a}),this},hasClass:function(e){if(this.exist(0)){var n=!1;return this.each(function(){var t=this.className;return n=0<=(" "+(m(t=t)?"":t)+" ").indexOf(" "+e+" ")}),n}},cls:function(t){if(m(t)){var e={};return this.each(function(){v.merge(e,p(this.className.split(/\s+/g)))}),e}var a=[],r=[],o=0;return l(t)?a=[t]:n(t)?a=p(t):v.map(t,function(t,e){(1===e?a:r).push(t)}),this.each(function(){var t=p(this.className.split(/\s+/g));for(o=0;o<a.length;o++){var e=a[o];e&&(t[e]=1)}for(o=0;o<r.length;o++)delete t[r[o]];var n="";v.map(t,function(t){0===n.length?n+=t:n+=" "+t}),this.className=n}),this},on:function(n,a,r){return n=b(n),this.each(function(){function t(t){var e=t.currentTarget;return a.call(e,t)}t._cb=a,t._uc=r,this.addEventListener(n,t,r);var e=(e=this===o?u:this._handlers||(this._handlers={}))[n]||(e[n]=[]);e.indexOf(t)<0&&e.push(t)}),this},trigger:function(e,t){e=b(e);var n=this,a=function(e,n,a){try{var r=new Event(e);return r.target=n,r}catch(t){r=n instanceof g?n.get(0):null;return{type:e,target:n,currentTarget:r,custom:!0,source:a,stopPropagation:function(){a&&a.stopPropagation()},preventDefault:function(){a&&a.preventDefault()}}}}(e,n,t);this.each(function(){var t;a.custom?(t=this===o?u:this._handlers)&&e in t&&t[e].forEach(function(t){return t.call(n,a)}):this.dispatchEvent(a)})},off:function(a,r){return a=b(a),this.each(function(){var t=this===o?u:this._handlers;if(t&&a in t){var e,n=t[a];if(r){for(e=0;e<n.length;e++)if(n[e]._cb===r){this.removeEventListener(a,n[e],n[e]._uc),n.splice(e,1),0===n.length&&delete t[a];break}}else{for(e=0;e<n.length;e++)this.removeEventListener(a,n[e],n[e]._uc);delete t[a]}}}),this},text:function(t){var e=arguments.length;if(0!==e)return t=(t=1<e?v.format.apply(v,arguments):t)||"",this.each(function(){this.textContent=t});var n="";return this.each(function(){n+=this.textContent}),n},value:function(t){var e=this.get(0);return null!=t?(e&&(e.value=t),this):e&&e.value||""},checked:function(){return this.get(0).checked||!1},parent:function(){var t=this.get(0);return t?v(t.parentNode):null},append:function(t){if(m(t))return this;var t=v(t),e=this.get(0);return e&&t.each(function(){e.appendChild(this)}),this},prepend:function(t){if(m(t))return this;var t=v(t),e=this.get(0);return e&&t.each(function(){0<e.childNodes.length&&e.firstChild?e.insertBefore(this,e.firstChild):e.appendChild(this)}),this},replace:function(t,e){if(m(t))return this;var t=v(t),n=this.get(0),a=e.get(0);return n&&t.each(function(){0<n.childNodes.length&&a&&a.parentNode===n?n.insertBefore(this,a):n.appendChild(this),n.removeChild(a)}),this},remove:function(){return this.each(function(){this.parentNode&&this.parentNode.removeChild(this)}),this},empty:function(){return this.inner("")},html:function(){var t=c.apply(arguments);if(0!==t.length)return this.each(function(){this.outerHTML=t[0]});var e="";return this.each(function(){this.outerHTML&&(e+=this.outerHTML)}),e},inner:function(){var t=c.apply(arguments);if(0!==t.length)return this.each(function(){this.innerHTML=t[0]});var e="";return this.each(function(){this.innerHTML&&(e+=this.innerHTML)}),e},tag:function(t,e){e=v.tag(t,e);return e._p=this,e},gat:function(){var t=this._p;return delete this._p,t.append(this)},appendText:function(t){return this.append(s.createTextNode(t)),this},exec:function(t){return t.call(this),this},attr:function(t,e){var n=this;if(void 0===t&&void 0===e){if(1===arguments.length)return this;var a,r={};if((a=n.get(0))&&a.attributes)for(var o=a.attributes.length,i=0;i<o;i++){var s=a.attributes[i];r[s.name]=s.value}return r}if(void 0===e&&f(t))for(var c in t)n.attr(c,t[c]);else{if(l(t)&&void 0===e)return(a=n.get(0)).hasAttribute(t)?a.getAttribute(t):void 0;this.each(function(){m(e)?this.removeAttribute(t):"cls"===t?n.cls(e):this.setAttribute(t,e)})}return this},data:function(t,e){if(0===arguments.length){var n=this.attr(),a={};for(var r in n)0===r.indexOf("data-")&&(a[r.substring(5)]=n[r]);return a}if(1===arguments.length){if(l(t))return this.attr("data-"+t);var o={};for(r in t)o["data-"+r]=t[r];this.attr(o)}else this.attr("data-"+t,e);return this},tap:function(e){var o,t=this;return e?(t.on("tap",function(t){return e.call(this,t)}),v.os.touch?(o=null,t.on("touchstart",function(t){(o=v(this)).__tap={};t=t.changedTouches[0];o.__tap.x=t.pageX,o.__tap.y=t.pageY+s.body.scrollTop}).on("touchmove",function(t){var e=t.changedTouches[0];o.__tap.toX=e.pageX,o.__tap.toY=e.pageY+s.body.scrollTop;e=o.__tap;if(!(Math.abs((e.toX||e.x)-e.x)<=10&&Math.abs((e.toY||e.y)-e.y)<=10))return o.trigger("tapout",t),!1}).on("touchend",function(t){t.preventDefault(),t.stopPropagation();var e=o.bound(),n=t.changedTouches[0],a=n.pageX-e.left,r=n.pageY-e.top,n=o.__tap;0<=a&&Math.abs((n.toX||n.x)-n.x)<=5&&Math.abs((n.toY||n.y)-n.y)<=5&&a<=e.width&&0<=r&&r<=e.height&&!o.attr("disabled")&&o.trigger("tap",t),delete o.__tap,o=null})):t.click(function(t){v(this).trigger("tap",t)})):t.trigger("tap"),t},over:function(e){function t(t){v(this).trigger("over",t)}return this.on("over",function(t){this.__over=!0,e.call(this,t)}),v.os.touch?e?this.on("touchstart",t):t():this.mouseover(t),this},tapout:function(e){return this.on("tapout",function(t){e.call(this,t)}),this},out:function(e){function t(t){v(this).trigger("out",t)}return this.on("out",function(t){this.__over&&(delete this.__over,e.call(this,t))}),v.os.touch?e?this.on("touchend",t):t():this.mouseout(t),this},visible:function(t){return this.css({visibility:t?"visible":"hidden"})},disable:function(){var e=this;function n(t){t.preventDefault()}return["touchstart","touchend","touchmove","mouseover","mouseout","mousedown","mouseup"].forEach(function(t){e.on(t,n)}),e}},["click","blur","change","error","focus","keydown","keyup","keypress","load","unload","mousedown","mouseup","mousemove","mouseout","mouseover","resize","scroll","select","submit","touchstart","touchmove","touchend"].forEach(function(e){g.prototype[e]=function(t){return t?this.on(e,t):this.trigger(e),this}});var t=navigator.userAgent;function a(t,e,n){this.count=0,this.loop=e||0,this.interval=t||0,this.delay=n||0,this.timerId=0}v.os={ua:t,touch:"ontouchstart"in document.documentElement,ios:/ip(hone|od|ad)/i.test(t),iphone:/iphone/i.test(t),ipad:/ipad/i.test(t),android:/android/i.test(t),mobile:/android.+mobile|ip(hone|od|ad)/i.test(t),webkit:/webkit/i.test(t)},v.tag=function(t,e){e=e||{};var n=t.indexOf("#"),a=t.indexOf(".");if(0<n&&(e.id=0<a?t.substring(n+1,a):t.substring(n+1)),0<a)for(var r=t.substring(a+1).split("."),o=0;o<r.length;o++){var i=r[o];e.cls?e.cls+=" "+i:e.cls=i}return t=0<n?t.substring(0,n):0<a?t.substring(0,a):t,v(s.createElement(t)).attr(e)},v.fragment=function(){return v(document.createDocumentFragment())},v.extend=function(t){v.map(t,function(t,e){g.prototype[t]=e})},v.map=function(t,e){if(t)for(var n in t)t.hasOwnProperty(n)&&e.call(t,n,t[n])},v.viewport=function(){return{window:{width:o.innerWidth,height:o.innerHeight,offset:{x:o.pageXOffset,y:o.pageYOffset}},screen:{width:screen.width,height:screen.height},zoom:screen.width/o.innerWidth}},v.cookie=function(t,e,n){if(1===arguments.length)for(var a=document.cookie.split(";"),r=0;r<a.length;r++){var o,i=(o=a[r]).indexOf("=");if(t===d(o.substring(0,i)))return d(o.substring(i+1))}else{o=t+"="+escape(e||"");var s=null;n?(s=new Date).setDate(s.getDate()+n):e||(s=new Date(0)),s&&(o+="; expires="+s.toUTCString()),document.cookie=o}},v.session=function(t,e){if(1!==arguments.length)return m(e)?sessionStorage.removeItem(t):sessionStorage.setItem(t,JSON.stringify(e)),this;var n=sessionStorage.getItem(t);return n?JSON.parse(n):null},v.storage=function(t,e){if(1!==arguments.length)return m(e)?localStorage.removeItem(t):localStorage.setItem(t,JSON.stringify(e)),this;var n=localStorage.getItem(t);return n?JSON.parse(n):null},(v.format=function(){var t=arguments;return t[0]?t[0].replace(/\{(\d+)\}/g,function(){return t[arguments[1]]}):null}).digit=function(t,e){if(""===(t=String(t)))return t;var n=t.length;if(e<=n)return t;for(var a=e-n,r="",o=0;o<a;o++)r+="0";return r+t},a.prototype={lastTap:null,paused:!(v.listenize=function(t){t.prototype.on=function(t,e){if(f(t))for(var n in t)this.on(n,t[n]);else{this._events||(this._events={});var a=this._events[t];a?a.push(e):this._events[t]=[e]}return this},t.prototype.off=function(t,e){var n,a,r=this;return 1===arguments.length?delete this._events[t]:"function"==typeof handler?!(n=this._events[t])||0<=(a=n.indexOf(e))&&(n.splice(a,1),0===n.length&&delete this._events[t]):c.apply(arguments).forEach(function(t){r.off(t)}),this},t.prototype.trigger=function(){if(this._events){var t=c.apply(arguments),e=t.shift(),n=this._events[e];if(n)for(var a=0;a<n.length;a++){var r=n[a].apply(this,t);if(!1===r||1===r)return!1}return!0}}}),executedTime:0,pastFromPrev:0,start:function(){var t=this;return t.paused=!1,0<t.delay?t.timerId=setTimeout(function(){t.next()},t.delay):t.next(),t},next:function(){var t=this;t.end||t.paused||(t.count++,t.executedTime=(new Date).getTime(),t.trigger("timer"),0<t.loop&&0==--t.loop||(t.timerId=setTimeout(function(){t.next()},t.interval)))},pause:function(){this.paused=!0,this.pastFromPrev=(new Date).getTime()-this.executedTime,clearTimeout(this.timerId)},resume:function(){var t=this;this.paused=!1,this.timerId=setTimeout(function(){t.next()},t.interval-t.pastFromPrev)},stop:function(){return this.end=!0,clearTimeout(this.timerId),this}},v.listenize(a),v.timer=function(t,e,n){return new a(t,e,n)},v.now=function(){return(new Date).getTime()},v.parseQuery=function(t){if(null===t)return!1;var e;(t=t||location.search)||(i=(e=location.href).indexOf("?"),t=e.substring(i+1));for(var n={},a=(t="?"===t.charAt(0)?t.substring(1):t).split("&"),r=0;r<a.length;r++){var o=a[r],i=o.indexOf("="),o=[o.substring(0,i),o.substring(i+1)];if(2===o.length)try{n[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}catch(t){}}return n},v.createQuery=function(t){var e,n="";for(e in t)n+=encodeURIComponent(e)+"="+encodeURIComponent(t[e])+"&";return n.slice(0,-1)},v.parseHash=function(t){if(!(t=t||location.hash))return!1;for(var e={},n=(t="#"===t.charAt(0)?t.substring(1):t).split("&"),a=0,r=n.length;a<r;a++){var o=n[a].split("=");2===o.length?e[decodeURIComponent(o[0])]=decodeURIComponent(o[1]):1===o.length&&(e[decodeURIComponent(o[0])]="")}return e};var r=new RegExp("/([^/]+?:[0-9]+):");function _(t,e){var n=(new Error).stack;n&&(!(n=n.split(/\n/)[3])||(n=r.exec(n))&&(n=n[1],e.push("("+n+")"))),e.unshift("["+t+"]"),v.os.ios||v.os.android?console.log(e.join(" ")):console.log.apply(console,e)}var y={debug:function(){_("DEBUG",c.apply(arguments))},info:function(){_("INFO",c.apply(arguments))},warn:function(){_("WARN",c.apply(arguments))},error:function(){_("ERROR",c.apply(arguments))},fatal:function(){_("FATAL",c.apply(arguments))}};function k(){}v.log=y,v.setLogLevel=function(t){switch(t){case"FATAL":y.error=k;case"ERROR":y.warn=k;case"WARN":y.info=k;case"INFO":y.debug=k}},v.isString=l,v.isObject=f,v.isFunction=function(t){return"function"==typeof t||t instanceof Function},v.isNumber=h,v.isArray=n,v.isNull=m,v.isEmptyObject=function(t){for(var e in t)return!1;return!0},o.AMB.chikuwa=v}(window),function(){var r,t;AMB&&(r=AMB.chikuwa,t=AMB.config,t=r.session(t.key.logLvl)||{},AMB.logLevel=t.value||AMB.logLevel,r.setLogLevel(AMB.logLevel),r.os.version=(t=navigator.userAgent.match(/(OS|Android) ([0-9_\.]+){1,3}/))?parseInt((t[2].replace(/_|\./g,"")+"00").slice(0,3)):0,AMB.chikuwa.storage=function(t,e,n){if(1===arguments.length){var a=localStorage.getItem(t);return a?JSON.parse(a):null}if(r.isNull(e))localStorage.removeItem(t);else try{localStorage.setItem(t,JSON.stringify(e))}catch(t){if("QUOTA_EXCEEDED_ERR"!==t.name)throw t;!function(t){for(var e in localStorage)-1!==e.indexOf(t)&&r.storage(e,null)}(n||"_amb")}return this},AMB.chikuwa.session=function(t,e,n){if(1===arguments.length){var a=sessionStorage.getItem(t);return a?JSON.parse(a):null}if(r.isNull(e))sessionStorage.removeItem(t);else try{sessionStorage.setItem(t,JSON.stringify(e))}catch(t){if("QUOTA_EXCEEDED_ERR"!==t.name)throw t;!function(t){for(var e in sessionStorage)-1!==e.indexOf(t)&&r.session(e,null)}(n||"_amb")}return this},AMB.chikuwa.cache=function(){var t,e,n;return 1===arguments.length?(e=r.storage(arguments[0])||{},(new Date).getTime()<e.expireIn?e.data:(r.storage(arguments[0],null),!1)):(2===arguments.length?r.storage(arguments[0],null):3===arguments.length&&(t=arguments[0],e=arguments[1],n=arguments[2],r.storage(t,{expireIn:(new Date).getTime()+n,data:e})),!1)},r.extend({button:function(t,e){var n=e&&"isTapout"in e&&e.isTapout;return this.over(function(){r(this).cls({amb_tap:1})}).tapout(function(){n&&r(this).cls({amb_tap:-1})}).out(function(){n||r(this).cls({amb_tap:-1})}).tap(t).css({cursor:"pointer","-webkit-user-select":"none"}),this}}))}(),function(){var l,h,n,f,t,e;function m(t){t=t||"access_token";if(l.storage(h.key.storage)){var e=l.storage(h.key.token);return e&&e[t]}return n[t]}function u(t){return t&&(l.storage(h.key.storage)?(f.debug("Set token in storage",t.access_token),l.storage(h.key.token,t)):(f.debug("Set token on memory",t.access_token),n=t),1)}function a(t){var r=t.method,o=t.path,i=t.data,s=t.auth,a=this,c=a.xhr=new XMLHttpRequest;var o=function(t){var e=document.createElement("a");e.href=t,t+=e.search?"&":"?",t+="from=jssdk",l.os.android&&(t+="&now="+(new Date).getTime());return t}(o),t=l.os.android?3e3:1e4,u=0;c.timerId=setTimeout(function(){c.abort(),a.trigger("loaded",c),a.trigger("error",{code:"timeout",message:"timeout"})},t),c.onreadystatechange=function(){var t,e,n;4!==u&&(t=c.readyState,4===(u=t)?0!==(n=c.status)&&(clearTimeout(c.timerId),e="{"===c.responseText.charAt(0)?JSON.parse(c.responseText):c.responseText,n=200<=n&&n<300?"complete":(f.error("HTTP",c.statusText,r,o),l.session(h.key.bootstrap)&&l.session(h.key.bootstrap,null),"error"),a.trigger(n,e)):t<4&&a.trigger(["init","loading","loaded","interactive"][t],c))},setTimeout(function(){c.open(r,o);var t,e,n,a=i?JSON.stringify(i):null;s&&(t=m(),e=l.storage(h.key.clientId),n=l.storage(h.key.sessionId),t&&c.setRequestHeader("Authorization","OAuth "+t),e&&c.setRequestHeader("X-ClientId",e.value),n&&c.setRequestHeader("X-SessionId",n.value)),c.send(a)},0)}function r(t){var n=(t=t||{}).auth||0;return{get:function(t,e){return e&&(t+=(e=l.createQuery(e))?"?"+e:""),new a({method:"GET",path:t,auth:n})},post:function(t,e){return new a({method:"POST",path:t,data:e,auth:n})},put:function(t,e){return new a({method:"PUT",path:t,data:e,auth:n})},del:function(t){return new a({method:"DELETE",path:t,auth:n})}}}AMB&&(l=AMB.chikuwa,h=AMB.config,n={},f=l.log,AMB.configure=function(t){f.debug("Begin to configure");var t=t||{},e=l.storage(h.key.clientId)||{},n=t.clientId||"",a=m(),r=t.token||"",o=t.storage||0,i=t.sessionId||"",s=t.redirectUrl||"",c=t.callbackUrl||"";o?l.storage(h.key.storage,{value:!0}):(l.storage(h.key.storage)&&l.storage(h.key.storage,null),l.storage(h.key.token)&&l.storage(h.key.token,null)),n&&e.value!==n&&l.storage(h.key.clientId,{value:n}),r&&a!==r&&u({access_token:r}),t.scope&&(AMB.config.scope=t.scope),i&&l.storage(h.key.sessionId,{value:i}),l.storage(h.key.config,{redirectUrl:s,callbackUrl:c})},AMB.bootstrap=function(){var t,e;f.debug("Begin to bootstrap"),l.cache(h.key.call)||(e=(t=new Date).getTime(),e=6e4*(60-t.getMinutes(e))-1e3*t.getSeconds(e),l.cache(h.key.call,{},e),AMB.track.action({name:"call"}));for(var n=Array.prototype.slice.apply(arguments),a=function(){},r=0,o=n.length;r<o;r++)l.isFunction(n[r])?a=n[r]:l.isObject(n[r])&&n[r];a({auth:1})},AMB.status=function(t){if(!m())return f.debug("User Status, NOT authorized because of not having token"),void t({auth:0});t({auth:1})},AMB.logout=function(t){(t=t||m())||f.error("Logout failed"),l.storage(h.key.me,null),l.session(h.key.me,null),l.storage(h.key.storage)?(f.debug("Remove token from storage"),l.storage(h.key.token)&&l.storage(h.key.token,null)):(f.debug("Remove token from memory"),n={});var e="https://rd.amca.jp/tjVBI66HmfjMOHktNiWQ",t={access_token:t,callback:location.href};e+="?"+l.createQuery(t),location.href=e},AMB.authorize=function(t){t=AMB.authorize.url(t);f.debug("Redirect to authorize",t),location.href=t},AMB.authorize.url=function(t){t=function(t){var e={client_id:t.clientId||l.storage(h.key.clientId)&&l.storage(h.key.clientId).value||"",response_type:t.response_type||"code",scope:(t.scope?t:h).scope.join(",")};t.state&&(e.state=t.state);"token"===e.response_type&&(e.redirect_uri=encodeURI(location.href));{var n;t.callbackUrl?e.redirect_uri=t.callbackUrl:(n=l.storage(h.key.config)).callbackUrl&&(e.redirect_uri=n.callbackUrl)}t.frm_id?e.frm_id=t.frm_id:l.session(h.key.fid)&&(e.frm_id=l.session(h.key.fid).value);t.provider_id&&(e.provider_id=t.provider_id);return e}(t=t||{});return h.url.auth+"/authorize?"+l.createQuery(t)},l.listenize(a),l.http=r(),l.http.authorized=r({auth:1}),(t=l.parseHash()).access_token&&(f.debug("Catch a token from the query?",t.access_token),(e={}).access_token=t.access_token,u(e)&&(l.storage(h.key.storage)&&l.storage(h.key.storage).value?location.replace(location.protocol+"//"+location.host+location.pathname):location.hash="")))}(),AMB&&(AMB.api=function(t,e){e(null)},AMB.api.get=AMB.api,AMB.api.post=function(t,e,n){n(null)},AMB.api.put=function(t,e){e(null)},AMB.api.del=function(t,e){e(null)}),function(){var e,n;AMB&&(e=AMB.chikuwa,n=AMB.config,AMB.bootstrapApi=function(t,e){e({associated:0})},AMB.register=function(t){t={callback:t=(t=t&&t.redirectUrl)||((e.storage(n.key.config)||{}).redirectUrl||location.href)},e.log.info("Bootstrap API, begin to register",t),location.href=n.url.home+"/#register?"+e.createQuery(t)})}(),function(){var a,r,o,i,t;function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}AMB&&(a=AMB.chikuwa,r=AMB.config,o=a.http.authorized,AMB.track={action:function(t,e){var n=(t=t||{}).name||"",a=t.option||"",t=t.vars||{};return new i(n,a,t).track(e)},access:function(t){var e,n;a.cache(r.key.call)?t&&t(null,{}):(n=(e=new Date).getTime(),n=6e4*(60-e.getMinutes(n))-1e3*e.getSeconds(n),a.cache(r.key.call,{},n),AMB.track.action({name:"call"},t))}},(i=function(t,e,n){this.name=t||"",this.vars=n||{},e&&(a.isString(e)?this.option=e:a.isArray(e)&&(this.option=e.join(",")))}).prototype={track:function(e){var n=this.createParams(),t=a.createQuery(n),t=r.url.tracking+"/track/log?"+t;try{o.get(t).on({complete:function(){a.log.info("tracking OK",n),a.isFunction(e)&&e(null,n)},error:function(t){a.log.info("tracking ERROR",n),a.isFunction(e)&&e(t,n)}})}catch(t){a.log.info("tracking ERROR",t),a.isFunction(e)&&e(null,n)}},createParams:function(){var t=a.session(r.key.fid)||{};return{action:this.name,tz:(new Date).getTimezoneOffset(),lang:navigator.language,platform:navigator.platform,referrer:document.referrer,url:location.href,option:this.option||"",fid:t.value||"",var1:this.vars.var1||"",var2:this.vars.var2||"",var3:this.vars.var3||"",var4:this.vars.var4||"",var5:this.vars.var5||""}}},a.storage(r.key.sessionId)||a.storage(r.key.sessionId,{value:e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}),(t=a.parseQuery())&&t.frm_id&&a.session(r.key.fid,{value:t.frm_id}))}(window),function(o){var m,p,d,g,v,t,b,e,n,c,a,r,_,i;function y(){var t=m.storage(d.key.clientId);return t&&t.value?t.value:""}function s(){var t=c(d.key.app);return t&&t.application&&t.application.id||""}function u(t){return t+"-"+s()}function l(t,e){if(!t)return!1;if(!e)return t;var n=document.createElement("a");return n.href=t,"link.ameba.jp"===n.host?n.pathname+=m.createQuery(e):n.search?n.search=function(t,e){for(var n in e)t[n]?t[n]=t[n]+"_"+e[n]:t[n]=e[n];return m.createQuery(t)}(m.parseQuery(n.search),e):n.search=m.createQuery(e),n.href}function h(e){var n=m.session(d.key.me)||{},t=n.status||{};t.auth?e(t):AMB.status(function(t){n.status=t,m.session(d.key.me,n),e(t)})}function f(){h(function(t){var e;t.auth&&(e=null)&&(a.header&&_.header.update({noti:e}),a.footer&&_.footer.update({noti:e}))})}function k(){t||(f(),(t=m.timer(d.noti.interval,0,d.noti.interval)).on("timer",function(){f()}),t.start())}function A(t,e,n){var a=m.format("amb_anchor amb_connect_item amb_connect_"+e),r=b[v];n.provider_id=e;var n=AMB.authorize.url(n),o="login"===t,t=o?r.login:r.start;return p("a",{href:n}).cls(a).button().tag("div.amb_item_wrap.amb_box").tag("i.amb_service_icon").gat().tag("p.amb_text.amb_title").tag("span.amb_provider_name").text(r.connect[e]).gat().appendText(m.format(r.common.by,"")+t).exec(function(){o&&"ameba"===e&&this.tag("div.amb_login_note").text(r.connect.note.ameba).gat()}).gat().gat()}AMB&&(m=AMB.chikuwa,p=m.tag,d=AMB.config,g=m.http,m.http.authorized,v="ja",t="",b={ja:{contact:"お問い合わせ",payment:"コイン購入",invite:"友だち招待",ameba:"Ameba",home:"ホーム",apps:"コミュニティ&ゲーム",myApps:"マイアプリ",blog:"ブログを書く",game:"ゲーム",news:"トピックス",category:"カテゴリ",more:"もっと見る",gameMore:"もっとゲームで遊ぼう",fresh:"新規",member:"会員",registration:"登録",free:"（無料）",start:"はじめる",login:"ログイン",list:"一覧",help:{top:"ヘルプ",rmt:"禁止行為について"},connect:{ameba:"アメーバID",yahoo:"Yahoo! JAPAN ID",twitter:"Twitter",google:"Google",facebook:"Facebook",mail:"メールアドレス",note:{ameba:"PC、ケータイのアメーバIDでもご利用頂けます",base:"※Ameba以外のサービスをご利用の場合{rule}と{help_cnct}に同意の上、ログインしてください。",rule:"利用規約",help_cnct:"外部サービスとのID連携に関する同意事項"}},common:{to:"{1}へ",by:"{1}で",execute:"{1}する",auxiliary:{no:"{1}の",ni:"{1}に",kara:"{1}から",wo:"{1}を",kara_wo:"{1}から{2}を"}},date:{format:{MD:"{1}月{2}日"}}}},e=0,e=(e=o.devicePixelRatio)||1,d.noti={},d.noti.interval=d.dev?1e4:18e4,d.path={fun:"/frames?type=fun&location=footer",footerText:"/frames?type=text&location=footer"},d.fid={hlogo:"c.amm-header_l.dr-home_r.am-mini",hnoti:"c.amm-header_l.dr-noti_r.am-mini",hLogin:"v.mini-com-header_registration",fhome:"c.amm-footer_l.dr-home_r.am-mini",fmyApps:"c.amm-footer_l.dr-myapps_r.am-mini",fblog:"c.amm-footer_l.dr-blog_r.am-mini",fnews:"c.amm-footer_l.dr-news_r.am-mini",fgame:"c.amm-footer_l.dr-gtop_r.am-mini",finvitation:"c.amm-footer_l.dr-invitation_r.am-mini",fcontact:"c.amm-footer_l.dr-contact_r.am-mini",fcategory:"c.amm-footer_l.dr-category-{1}_r.am-mini",fcategory_more:"c.amm-footer_l.dr-category-more_r.am-mini",fpr:"c.amm-footer_l.dr-pr-{1}_r.am-mini"},m.os.caApp=/CaWebApp/i.test(m.os.ua),m.os.iosCaApp=m.os.ios&&m.os.caApp,m.os.android,AMB.ui=function(){var t=Array.prototype.slice.apply(arguments),e=t.shift();return r[e].init.apply(r[e],t)},AMB.footer=function(t,e){AMB.ui("footer",t,e)},AMB.header=function(t,e){AMB.ui("header",t,e)},AMB.modal=function(t,e){return AMB.ui("modal",t,e)},AMB.modal.close=function(){_.modal.close()},m.date={parseISO8601:function(t,e){if(!t)return null;void 0===e&&(n=-1*(new Date).getTimezoneOffset()/60,e=Number(n));var n=36e5*e,e=(t=t.replace(/Z|T/g,"")).match(/([\d]{4})-([\d]{2})-([\d]{2}).*([\d]{2}):([\d]{2}):([\d]{2})/),t={y:Number(e[1]),m:Number(e[2]),d:Number(e[3])},e={h:Number(e[4]),m:Number(e[5]),s:Number(e[6])},e=new Date(t.y,t.m-1,t.d,e.h,e.m,e.s);return 0!=n&&e.setTime(e.getTime()+n),e}},c=m.cache,a={footer:0,header:0},r={header:{init:function(e,t){if(!m(e))return!1;var n=this.options(t);this.data(function(t){_.header.init(e,n,t)})},options:function(t){return(t=t||{}).template="amb_"+(t.template||"default"),t.prepend=m.isNull(t.prepend)?1:t.prepend,t.loginBtn=m.isNull(t.loginBtn)?1:t.loginBtn,t},data:function(e){var n={};h(function(t){n.status=t=t||{},e(n)})}},footer:{init:function(e,n){if(!m(e))return!1;var a=this;this.data(function(t){a.opts=a.options(n),_.footer.init(e,a.opts,t)})},data:function(e){var n={};h(function(t){n.status=t=t||{},e(n)})},options:function(t){(t=t||{}).util=m.isNull(t.util)?1:t.util,t.actions=m.isNull(t.actions)?1:t.actions,t.payment=m.isNull(t.payment)?1:t.payment,t.invite=m.isNull(t.invite)?1:t.invite,t.banner=m.isNull(t.banner)?1:t.banner,t.bar=m.isNull(t.bar)?1:t.bar,t.copy=m.isNull(t.copy)?1:t.copy,t.overrideUrls=t.overrideUrls||{};var e=(e=m.cache(d.key.app)||{}).application||{},n="game";return"game"===t.category||"community"===t.category?n=t.category:"game"!==e.category&&"community"!==e.category||(n=e.category),t.category=n,t.contentsType=m.isNull(t.contentsType)?"default":t.contentsType,t}},modal:{init:function(t,e){return(e=this.options(t,e))&&_.modal.init(t,e),{close:function(){_.modal.close()}}},options:function(t,n){if(!(["login","register"].indexOf(t)<0))return n=n||{},["disableForm","animate"].forEach(function(t){var e=n[t];m.isNull(e)?n[t]=1:n[t]=e?1:0}),n}}},_={header:{init:function(t,e,n){a.header=1,this.parent=m(t),this.opts=e,this.data=n,this.container=p("header#amb_header"),this.btnNoti=p("button#amb_noti").cls("amb_button"),this.notiCounter=p("span.amb_header_noti_counter"),this.loginBtn=p("p#amb_header_login"),this.render()},render:function(){var t=this,e=this.opts,n=this.data,a=b[v];n.app=n.app||{};var r=this.container;r.cls(e.template+" amb");var o=p("p#amb_ci").tag("a.amb_anchor amb_ci_text").button().attr({href:l(d.amebame.url.home_header,{frm_id:u(d.fid.hlogo)})}).text(m.format(a.common.to,a.home)).gat();this.btnNoti.button(function(){location.href=l(d.url.www+"/notifications")});var i,s=(s=t.loginBtn,t=(i=c(d.key.app))&&i.application&&i.application.device&&i.application.device.web&&i.application.device.web.path&&i.application.device.web.path.login||""||AMB.config.amebame.url.home_header,i=a.member+a.registration+a.free,t?(t=l(t,{callback:location.href,frm_id:u(d.fid.hLogin)}),s.tag("a.amb_anchor amb_button").attr({href:t}).text(i).button().gat()):s=null,s);r.append(o),n.status.auth?(this.btnNoti.append(this.notiCounter.visible(0)),r.append(this.btnNoti)):e.loginBtn&&s&&r.append(s),e.prepend?this.parent.prepend(r):this.parent.append(r),n.status.auth&&k()},update:function(t){(t=t||{}).noti&&this.setNotiSummary(t.noti)},deleteCounter:function(){this.notiCounter.text("").visible(0)},setNotiSummary:function(t){m.log.debug("Call header setNotiSummary"),t.summary&&t.summary.unreadCount?(t=10<=t.summary.unreadCount?"+":t.summary.unreadCount,this.notiCounter.text(t).visible(1)):this.deleteCounter()}},footer:{init:function(t,e,n){a.footer=1,this.parent=m(t),this.opts=e,this.data=n,this.noti,this.container=p("div#amb_footer").cls("amb"),this.prBox=p("div#amb_footer_fun_box"),this.render()},update:function(t){(t=t||{}).noti&&this.setNotiSummary(t.noti)},render:function(){var n,a,e=this,t=this.opts,r=this.data,o="game"===t.category,i=y(),s=b[v],c=this.parent,u=this.container,l=(h=p("ul#amb_footer_utility"),i&&h.tag("li.amb_utility_item").tag("a.amb_anchor amb_tx_link").button().attr({href:"https://rd.amca.jp/3NaYwMQ4jwWNMqWUcVe7"}).text(s.contact).gat().gat(),t.overrideUrls.help&&h.tag("li.amb_utility_item").tag("a.amb_anchor amb_tx_link").button().attr({href:t.overrideUrls.help}).text(s.help.top).gat().gat(),o&&(f=t.overrideUrls.rmt||d.url.help_rmt,h.tag("li.amb_utility_item").tag("a.amb_anchor amb_tx_link").button().attr({href:f}).text(s.help.rmt).gat().gat()),h),o=p("div#amb_navWrap"),h=(f=p("nav#amb_nav"),n=p("ul.amb_nav_list"),a=["https://rd.amca.jp/aBgi18Pp83T76MaflaQP","https://rd.amca.jp/ttJbULnHx8i97ky1fuoq","https://rd.amca.jp/g0NDIWBk75BEAlWrnNtL","https://rd.amca.jp/9mQa7NbYFxLUGtJ6QS6A"],["home","game","blog","payment"].forEach(function(t,e){e=a[e],e=p("li.amb_nav_item amb_"+t).tag("a.amb_anchor").button().attr({href:e}).tag("i.amb_icon").gat().tag("span.amb_label").text(s[t]).gat().gat();"home"===t&&e.tag("span.amb_footer_nav_counter").visible(0).gat(),n.append(e)}),f.append(n),f),f=p("p#amb_copyright").text("© CyberAgent, Inc.");t.bar&&u.append(o),t.bar&&o.append(h),r.status.auth&&!m.os.iosCaApp&&t.banner&&u.append(e.prBox),i&&t.util&&u.append(l),r.status.auth&&!m.os.iosCaApp&&t.banner&&_.footer.update(r),t.copy&&u.append(f),c.append(u),r.status.auth&&k(),r.status.auth&&!m.os.iosCaApp&&t.banner&&function(t,e){m.isArray(t)||e({});var n=!0,a=(a=m.storage(d.key.me))&&a.u,t=d.url.adcross+"/"+t.join(",");a&&(t+=(n?"?":"&")+"du="+a,n=!1),g.get(t+=(n?"?":"&")+"iss=true").on({complete:function(t){e(t)},error:function(t){e({})}})}([2755],function(t){m.isEmptyObject(t)||m.isEmptyObject(t.results)||(t=t.results[0],m.isEmptyObject(t)||200!==t.status?e.prBox.remove():e.addPrBox(t))})},setNotiSummary:function(t){m.log.debug("Call footer setNotiSummary"),this.noti=m(".amb_nav_item.amb_home"),this.noti.counter=m(".amb_nav_item.amb_home span.amb_footer_nav_counter"),t.summary&&t.summary.unreadCount?(t=99<t.summary.unreadCount?"99+":t.summary.unreadCount,this.noti.counter.text(t).visible(1)):this.noti.counter.empty().visible(0)},deleteCounter:function(){this.noti.counter.visible(0)},addPrText:function(t){var e=t.creatives&&t.creatives[0],n=e.click_url,e=e.text;n&&e&&p("a.amb_footer_text_pr",{href:n,target:t.target}).text(e)},addPrBox:function(t){var e=t.creatives&&t.creatives[0],n=e.click_url,e=e.img_url;n&&e&&(t=p("a.amb_footer_fun",{href:n,target:t.target}).tag("img",{src:e,width:t.width}).gat(),this.prBox.append(t))}},modal:{init:function(t,e){var n=this,a=n.blocker,r=n.container;if(r&&a)return n.renderContent(t,e),void n.adjust();(r||a)&&n.close(),n.render(t,e)},render:function(t,e){var n=this,a=n.animate=e.animate,r=n.blocker=p("div#amb_modal_overlay.amb").disable(),o=n.container=p("div#amb_modal_container.amb");a&&(r.cls(a="amb_modal_animate"),o.cls(a)),n.winEvent(1),e.disableForm&&n.disableForm(1),setTimeout(function(){var t="amb_visible";n.adjust(),r.cls(t),o.cls(t)},100),o.tag("button.amb_close_btn").button(function(){n.close()}).tag("div.amb_btn_content").gat().gat(),m("body").append(r).append(o),n.renderContent(t,e)},winEvent:function(t){var e=this,n=e._win||(e._win=m(o)),a=t?"on":"off",r=m.os.touch?"touchmove":"mousemove",t=(t=e._event)||(e._event={disable:function(t){t.preventDefault()},adjust:function(){e.adjust()},reset:function(){e.close()}});n[a](r,t.disable),n[a]("orientationchange",t.adjust),n[a]("resize",t.adjust),n[a]("scroll",t.adjust),n[a]("hashchange",t.reset)},disableForm:function(t){var e=this._disabled||[];t?(m("select, input, textarea, button, fieldset").each(function(){var t=m(this);m.isNull(t.attr("disabled"))&&(t.attr("disabled","disabled"),e.push(this))}),this._disabled=e):e.length&&(m(e).attr("disabled",null),this._disabled=null)},adjust:function(){var t,e,n,a,r,o,i,s,c=this.blocker,u=this.container;(c||u)&&(c&&c.css({display:"none"}),t=(r=m.viewport().window).height,e=r.width,n=r.offset.x,a=r.offset.y,u&&(u.cls({amb_landscape:(r=t<e)?1:-1,amb_portrait:r?-1:1}),r=u.bound(),u.css({top:Math.floor((t-r.height)/2+a),left:Math.floor((e-r.width)/2+n)})),c&&c.css((o=document.body,i=document.documentElement,s={},["Height","Width"].forEach(function(t){var e="scroll"+t,n="offset"+t,a="client"+t;s[t.toLowerCase()]=Math.max(o[e],i[e],o[n],i[n],i[a])}),s)),c.css({display:"block"}))},close:function(){var a=this,t=a.container,e=a.blocker;function n(t){var e,n;a.animate?(e=0,t.on("transitionend",n=function(){e||(t.remove(),e=1)}).on("webkitTransitionEnd",n).cls({amb_visible:-1})):t.remove()}t&&(n(t),a.container=null),e&&(n(e),a.blocker=null),a.disableForm(0),a.winEvent(0)},renderContent:function(t,e){var n,a=this.container,r=this._oldc,o=p("div.amb_modal_content").attr("id","amb_modal_"+t);switch(t){case"login":n=function(t){var e=p("div"),n=p("div.amb_connect_service"),a=b[v],r=t||{};r.clientId||(r.clientId=y());var o=m.session(d.key.fid),t="l.jssdk_authpopup";return r.frm_id=o?o.value+"-_"+t:t,e.tag("p.amb_heading").text(m.format(a.common.auxiliary.ni,a.ameba)+a.login).gat(),["ameba","yahoo","twitter","google","facebook"].forEach(function(t){n.append(A("login",t,r))}),e.append(n).append(function(){var n=p("p.amb_note"),a=b[v].connect.note,t=a.base,e=/{\w+}/g,r=t.match(e);return t.split(e).forEach(function(t,e){0===e||(e=(e=r.shift())?e.replace(/{|}/g,""):"")&&n.tag("a.amb_anchor.amb_tx_link",{href:d.url[e]}).button().text(a[e]).gat(),t&&n.appendText(t)}),n}())}(e);break;case"register":n=function(t){var e,n=p("div"),a=b[v];e=m.os.ios?["yahoo","twitter","google"]:["google","twitter","yahoo"];e.push("facebook");var r=t||{};r.clientId||(r.clientId=y());var o=m.session(d.key.fid),t="l.jssdk_authpopup";r.frm_id=o?o.value+"-_"+t:t,n.tag("p.amb_heading").text(a.ameba+a.fresh+a.registration+a.free).gat();for(var i=p("div.amb_connect_pickup"),s=0;s<2;s++)i.tag("div.amb_table_row").append(A("register",e.shift(),r)).gat();var c,u=p("div.amb_connect_service");e.forEach(function(t,e){e%2==0&&(c=p("div.amb_table_row"),u.append(c)),c.append(A("register",t,r))}),e.length%2!=0&&c.tag("div.amb_table_item.amb_anchor.amb_connect_item").gat();r.provider_id="ameba";t=function(t,e){if(!t||!e)return t;var n=document.createElement("a");return n.href=t,n.pathname=e,n.href}(AMB.authorize.url(r),"/connect/signup/guest");return n.append(i).append(u).tag("a.amb_anchor.amb_button.amb_large.amb_negative.amb_connect_ameba",{href:t}).tag("i.amb_icon_mail").gat().appendText(m.format(a.common.by+a.start,a.connect.mail+a.registration)).button().gat()}(e)}a&&n?(r&&r.remove(),a.append(o.append(n)),this._oldc=o,AMB.track.action({name:"kpi-view",option:"amm_modal_"+t,vars:{var3:AMB.VERSION,var4:s()}})):this.close()}}},i=d.dev?"/pub/sdk/css/all.css":function(t){t=t.replace(/^\//,"");n="https:"===location.protocol?d.url.stat_ssl:d.url.stat;return n+"/"+t}("/pub/sdk/css/all-"+AMB.VERSION+".css"),m("head").append(p("link").attr({rel:"stylesheet",href:i})))}(window);